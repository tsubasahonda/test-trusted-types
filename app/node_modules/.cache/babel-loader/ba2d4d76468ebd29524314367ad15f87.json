{"ast":null,"code":"import tt from 'trusted-types';\nimport { URL } from 'url';\n\nconst noop = i => i;\n\nconst rules = {\n  createHTML: noop,\n  createURL: unsafe => {\n    console.log('createURL');\n    const unsafeurl = new URL(unsafe);\n    const currenturl = new URL(location.href);\n\n    if (unsafeurl.origin !== currenturl.origin) {\n      throw new Error('url of unexpected origin');\n    }\n\n    return unsafeurl;\n  }\n};\nlet appPolicy;\nlet withTrustedTypes = true;\nexport const getPolicy = () => {\n  if (withTrustedTypes && appPolicy === undefined) {\n    appPolicy = tt.createPolicy('app-policy', rules);\n  }\n\n  if (withTrustedTypes) return appPolicy;else return rules;\n};","map":{"version":3,"sources":["/Users/myaaaicey/Documents/playground/test-trusted-types/app/src/utils.ts"],"names":["tt","URL","noop","i","rules","createHTML","createURL","unsafe","console","log","unsafeurl","currenturl","location","href","origin","Error","appPolicy","withTrustedTypes","getPolicy","undefined","createPolicy"],"mappings":"AAAA,OAAOA,EAAP,MAAe,eAAf;AACA,SAASC,GAAT,QAAoB,KAApB;;AAEA,MAAMC,IAAI,GAAIC,CAAD,IAAYA,CAAzB;;AACA,MAAMC,KAAK,GAAG;AACZC,EAAAA,UAAU,EAAEH,IADA;AAEZI,EAAAA,SAAS,EAAGC,MAAD,IAAoB;AAC7BC,IAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ;AACA,UAAMC,SAAS,GAAG,IAAIT,GAAJ,CAAQM,MAAR,CAAlB;AACA,UAAMI,UAAU,GAAG,IAAIV,GAAJ,CAAQW,QAAQ,CAACC,IAAjB,CAAnB;;AACA,QAAIH,SAAS,CAACI,MAAV,KAAqBH,UAAU,CAACG,MAApC,EAA4C;AAC1C,YAAM,IAAIC,KAAJ,CAAU,0BAAV,CAAN;AACD;;AACD,WAAOL,SAAP;AACD;AAVW,CAAd;AAaA,IAAIM,SAAJ;AACA,IAAIC,gBAAgB,GAAG,IAAvB;AAEA,OAAO,MAAMC,SAAS,GAAG,MAAM;AAC7B,MAAID,gBAAgB,IAAID,SAAS,KAAKG,SAAtC,EAAiD;AAC/CH,IAAAA,SAAS,GAAGhB,EAAE,CAACoB,YAAH,CAAgB,YAAhB,EAA8BhB,KAA9B,CAAZ;AACD;;AAED,MAAIa,gBAAJ,EAAsB,OAAOD,SAAP,CAAtB,KACK,OAAOZ,KAAP;AACN,CAPM","sourcesContent":["import tt from 'trusted-types';\nimport { URL } from 'url';\n\nconst noop = (i: any) => i\nconst rules = {\n  createHTML: noop,\n  createURL: (unsafe: string) => {\n    console.log('createURL')\n    const unsafeurl = new URL(unsafe)\n    const currenturl = new URL(location.href)\n    if (unsafeurl.origin !== currenturl.origin) {\n      throw new Error('url of unexpected origin')\n    }\n    return unsafeurl\n  }\n}\n\nlet appPolicy: any;\nlet withTrustedTypes = true\n\nexport const getPolicy = () => {\n  if (withTrustedTypes && appPolicy === undefined) {\n    appPolicy = tt.createPolicy('app-policy', rules)\n  }\n\n  if (withTrustedTypes) return appPolicy\n  else return rules\n}\n"]},"metadata":{},"sourceType":"module"}